{
  "metadata": {
    "company_name": "注专 砖 LTD",
    "version": "1.0",
    "last_updated": "2024-03-21"
  },
  
  "configuration": {
    "rules": {
      "blockedSources": {
        "ignoreContacts": true,
        "ignoreArchived": true,
        "ignoreGroups": true,
        "ignoreStatus": true
      },
      "activation": {
        "enabled": true,
        "keywords": ["转住驻专转"],
        "resetAfterHours": 24
      }
    },
    
    "client_management": {
      "freeze": {
        "enabled": true,
        "duration": 60,
        "messaging": {
          "send_explanation": true,
          "message": "转专  注 {duration} 拽转. 转 注 住转! "
        }
      },
      "reset": {
        "enabled": true,
        "keyword": "转驻专",
        "target_step": "main_menu",
        "options": {
          "unfreeze": true,
          "delete_appointment": true,
          "allow_unblock": true
        }
      },
      "blockScheduledClients": {
        "enabled": true,
        "blockPastAndPresent": true,
        "blockFutureAndPresent": false,
        "allowRescheduling": true,
        "rescheduleOnlyFuture": true
      }
    }
  },
  

  "integrations": {
    "enabled": true,

    "googleWorkspace": {
      "enabled": true,
      "sheets": {
        "enabled": true,
        "sheetId": "1fVUvM0Zaj-G1oIzW0NHBOxktssEto_OZFn1JPZ44Nf0",
        "columns": {
          "meeting_date": 1,
          "meeting_time": 2,
          "full_name": 3,
          "city_name": 4,
          "phone": 5,
          "mobility": 6
        },
        "filterByDateTime": true,
        "preventDuplicates": true,
        "updateExistingRows": true
      },

      "calendar": {
        "enabled": true,
        "calendarId": "6c1877e19bcec67cf66fc0235c0420790d1534e7abea9b1dd64bd44d0a440dae@group.calendar.google.com",
        "eventDurationMinutes": 60,
        "timeZone": "Asia/Jerusalem",
        "eventTitle": "驻砖 注 {full_name}",
        "eventDescription": "驻砖 注 {full_name}\n驻: {phone}\n注专: {city_name}\n转: {mobility}",
        "maxParticipantsPerSlot": 3,
        "preventDuplicates": true
      }
    },

    "notifications": {
      "enabled": true,
      "meetingScheduled": {
        "enabled": true,
        "recipients": [
          "120363419789724883@g.us"
        ],
        "messageTemplateFile": "meeting_scheduled_notification.txt"
      }
    },
    
    "reminders": {
      "enabled": false,
      "configurations": [
        {
          "id": "reminder_12h_before",
          "offset": "-12h",
          "timeOfDay": "19:00",
          "messageFile": "reminder_12h_before.txt",
          "source": "google_sheet",
          "enabled": false
        },
        {
          "id": "reminder_1h_before",
          "offset": "-1h",
          "messageFile": "reminder_1h_before.txt",
          "source": "google_sheet",
          "enabled": true
        }
      ]
    },
    
    "iPlan": {
      "enabled": false,
      "apiUrl": "",
      "apiKey": "",
      "companyId": "",
      "syncMeetings": true,
      "syncContacts": false,
      "syncTasks": false
    }
  },

  "start": "intro",
  
  "steps": {
    "intro": {
      "id": "intro",
      "type": "message",
      "userResponseWaiting": false,
      "next": "main_menu",
      "messageFile": "intro.txt"
    },
    
    "main_menu": {
      "id": "main_menu",
      "type": "options",
      "userResponseWaiting": true,
      "options": {
        "1 || 驻砖 || 拽注 驻砖 || 拽注转 驻砖": "book",
        "2 || 砖转 || 注 || 驻专": "questions",
        "3 || 爪 || 爪 砖 || 专 注 爪": "human",
        "4 || 住专 || 住专 || ": "remove"
      },
      "branches": {
        "book": "start_booking_flow",
        "questions": "faq1",
        "human": "human_support",
        "remove": "remove_candidate"
      },
      "messageFile": "main_menu.txt"
    },

    "start_booking_flow": {
      "id": "start_booking_flow",
      "type": "message",
      "userResponseWaiting": false,
      "next": "ask_name",
      "messageFile": "start_booking_flow.txt"
    },

    "faq1": {
      "id": "faq1",
      "type": "options",
      "userResponseWaiting": true,
      "options": {
        "1 || 驻砖 || 拽注 驻砖": "book",
        "2 || 砖 注 住祝": "next_faq",
        "3 || 爪 || 爪 砖": "human",
        "9 || 住专 || ": "remove"
      },
      "branches": {
        "book": "start_booking_flow",
        "next_faq": "faq2",
        "human": "human_support",
        "remove": "remove_candidate"
      },
      "messageFile": "faq1.txt"
    },

    "faq2": {
      "id": "faq2",
      "type": "options",
      "userResponseWaiting": true,
      "options": {
        "1 || 驻砖 || 拽注 驻砖": "book",
        "2 || 专 转驻专": "menu",
        "3 || 爪 || 爪 砖": "human",
        "9 || 住专 || ": "remove"
      },
      "branches": {
        "book": "start_booking_flow",
        "menu": "main_menu",
        "human": "human_support",
        "remove": "remove_candidate"
      },
      "messageFile": "faq2.txt"
    },

    "human_support": {
      "id": "human_support",
      "type": "message",
      "userResponseWaiting": false,
      "messageFile": "human_support.txt",
      "freeze": true
    },

    "remove_candidate": {
      "id": "remove_candidate",
      "type": "message",
      "userResponseWaiting": false,
      "messageFile": "remove_candidate.txt",
      "freeze": true
    },

    "ask_name": {
      "id": "ask_name",
      "type": "question",
      "userResponseWaiting": true,
      "message": "* 砖 ?*",
      "key": "full_name",
      "validation": {
        "type": "Name"
      },
      "next": "confirm_full_name"
    },

    "confirm_full_name": {
      "id": "confirm_full_name",
      "type": "options",
      "userResponseWaiting": true,
      "message": " 砖  砖  *{full_name}*?\n1 - \n2 - , 注 转 砖",
      "options": {
        "1 ||  ||  || 住专 || 砖专": "confirmed",
        "2 ||  ||   || 转拽 || 砖": "retype_name"
      },
      "branches": {
        "confirmed": "ask_city",
        "retype_name": "ask_name_again"
      },
      "noMatchMessage": " 砖 '1'  ''  砖 ,  '2'  ''  注 转 砖."
    },

    "ask_name_again": {
      "id": "ask_name_again",
      "type": "question",
      "key": "full_name",
      "userResponseWaiting": true,
      "message": "* 爪 砖 转 砖 :*",
      "validation": {
        "type": "Name"
      },
      "next": "confirm_full_name"
    },

    "ask_city": {
      "id": "ask_city",
      "type": "question",
      "userResponseWaiting": true,
      "message": "* 注专 专?*",
      "key": "city_name",
      "validation": {
        "type": "Location"
      },
      "cityValidationConfig": {
        "messages": {
          "拽_专拽": " 转 注专.  住 砖转.",
          "注专__": "转转 转 注专 {cityName},  爪注专  驻注  专注. \n   注转  转 注专 专.",
          "爪注_注专__": " 转 注专 *{suggestedCity}*,   驻注  专注. \n  注转  转 注专 专.",
          "注专__专转": " 爪 转 转 注专 砖转 ({originalInput}).  住/ 砖转  拽砖/ 砖 注专 专转.",
          "专转_专": "专 转 砖 转  状转驻专状"
        }
      },
      "next": "ask_vehicle"
    },

    "ask_vehicle": {
      "id": "ask_vehicle",
      "type": "options",
      "userResponseWaiting": true,
      "message": "* 专转 转 砖?*\n1 - 专\n2 - 驻注\n3 -  ",
      "key": "mobility",
      "options": {
        "1 || 专 || 转 ||  || car": "car",
        "2 || 驻注 || 驻 || 拽 || bike": "bike",
        "3 ||   ||  ||  || none": "none"
      },
      "branches": {
        "car": "show_available_months",
        "bike": "show_available_months",
        "none": "not_suitable"
      }
    },

    "show_available_months": {
      "id": "show_available_months",
      "type": "date",
      "messageHeader": "*  专 砖 驻砖 转:*",
      "userResponseWaiting": true,
      "limit": 12,
      "resolution": "months",
      "next": "show_available_weeks",
      "options": { "专": "main_menu" },
      "footerMessage": "\n( 专 转驻专 专砖, 专砖 *专*)",
      "enabled": true,
      "skipIfDisabled": "show_available_weeks"
    },
    
    "show_available_weeks": {
      "id": "show_available_weeks",
      "type": "date",
      "messageHeader": "*  专 砖注 驻砖 转:*",
      "userResponseWaiting": true,
      "limit": 5,
      "resolution": "weeks",
      "next": "show_available_days",
      "options": { 
        "专": "show_available_months"
      },
      "footerMessage": "\n( 专转 砖 专, 专砖 *砖 专*)\n( 专 转驻专 专砖, 专砖 *专*)",
      "enabled": true,
      "skipIfDisabled": "show_available_days"
    },

    "show_available_days": {
      "id": "show_available_days",
      "type": "date",
      "messageHeader": "*  专  驻砖 转:*",
      "userResponseWaiting": true,
      "limit": 5,
      "resolution": "days",
      "startFromToday": false,
      "next": "show_available_times",
      "options": { 
        "专": "show_available_weeks",
        "砖注 专": "show_available_weeks",
        "砖 专": "show_available_dates"
      },
      "footerMessage": "\n( 专转  砖注 专, 专砖 *砖注 专*)\n( 专转  砖 专, 专砖 *砖 专*)\n( 专 转驻专 专砖, 专砖 *专*)",
      "enabled": true,
      "skipIfDisabled": "show_available_times"
    },

    "show_available_times": {
      "id": "show_available_times",
      "type": "date",
      "messageHeader": "*  专 砖注 驻砖 转:*",
      "userResponseWaiting": true,
      "limit": 20,
      "resolution": "hours",
      "next": "final_confirmation",
      "options": { 
        "专": "show_available_days"
      },
      "footerMessage": " 专转 "
    },

    "final_confirmation": {
      "id": "final_confirmation",
      "type": "message",
      "userResponseWaiting": false,
      "messageFile": "final_confirmation.txt",
      "block": true
    },

    "not_suitable": {
      "id": "not_suitable",
      "type": "message",
      "userResponseWaiting": false,
      "messageFile": "not_suitable.txt",
      "freeze": true
    }
  }
}